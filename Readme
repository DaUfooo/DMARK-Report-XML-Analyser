Das von mir erstellte PowerShell-Skript, verarbeitet XML-Dateien, die Berichte über SPF (Sender Policy Framework) und DKIM (DomainKeys Identified Mail) Authentifizierung enthalten.
Diese Berichte stammen in der Regel von E-Mail-Domain-Validierungsdiensten und helfen, die Authentizität von E-Mails zu überprüfen.

1. Überprüfung des Verzeichnisses
Das Skript überprüft, ob das Verzeichnis .\XML-Reports\ existiert, in dem die XML-Dateien erwartet werden:
Falls das Verzeichnis nicht vorhanden ist, gibt es eine Fehlermeldung aus und beendet das Skript.
Falls keine XML-Dateien im Verzeichnis gefunden werden, gibt es ebenfalls eine Fehlermeldung aus.

2. Verarbeitung der XML-Dateien
Daten extrahieren: Aus der XML-Datei werden wichtige Informationen extrahiert, darunter:
org_name (Name der Organisation)
email (E-Mail-Adresse der Organisation)
report_id (Berichts-ID)
domain (Die Domain, für die der Bericht gilt)
pct (Prozentsatz, der angibt, wie viele E-Mails den Authentifizierungstest durchlaufen sollen)
Der Zeitbereich des Berichts (Start- und Endzeit der E-Mail-Überprüfung)
Diese Daten werden formatiert und auf der Konsole ausgegeben.

3. Verarbeitung der Authentifizierungsergebnisse
Das Skript erstellt für jedes Ergebnis eine Tabelle, die folgende Spalten enthält:
ReportTime (Aktuelle Zeit)
Organisation (Name der Organisation)
SourceIP (IP-Adresse des Absenders)
SPF, SPFResult, SPFDomain (Details zu SPF)
DKIM, DKIMResult, DKIMDomain (Details zu DKIM)
Count (Anzahl der E-Mails)

4. Ergebnisse anzeigen
Nach der Verarbeitung aller Dateien wird eine Tabelle mit den zusammengefassten Ergebnissen für alle XML-Dateien angezeigt:
Die Tabelle listet die extrahierten und verarbeiteten Daten auf, damit der Benutzer die Authentifizierungsergebnisse für die jeweiligen Domains und Absender-IP-Adressen überprüfen kann.

Verarbeite Datei: yahoo.com!blabla.gv.at!1354454365!1453534535599.xml
Date Range: 2025-11-11 01:00:00 to 2025-11-12 00:59:59
Organisation: Yahoo
Email: dmarchelp@yahooinc.com
Percentage: 100

2025-11-14 14:32:00 Outlook.com                  209.85.128.185          fail pass       googlegroups.com              fail pass       googlegroups.com              1
2025-11-14 14:32:00 Outlook.com                  74.125.224.60           fail pass       googlegroups.com              fail pass       googlegroups.com              1
2025-11-14 14:32:00 Outlook.com                  123.44.122.122          pass pass       github.com                    pass pass       blabla.com                    3
2025-11-14 14:32:00 Outlook.com                  209.85.128.187          fail pass       googlegroups.com              fail pass       googlegroups.com              5
2025-11-14 14:32:00 Outlook.com                  209.85.128.188          fail pass       googlegroups.com              fail pass       googlegroups.com              2
2025-11-14 14:32:00 Outlook.com                  0.0.0.0                 pass pass       agithub.com                   pass pass       blabla.com                    3
2025-11-14 14:32:00 Outlook.com                  74.125.224.59           fail pass       googlegroups.com              fail pass       googlegroups.com              1
2025-11-14 14:32:00 Outlook.com                  133.36.133.111          pass pass       github.com                    pass pass       blabla.com                    2
2025-11-14 14:32:00 Outlook.com                  209.85.128.183          fail pass       googlegroups.com              fail pass       googlegroups.com              5
2025-11-14 14:32:00 Outlook.com                  74.125.224.55           fail pass       googlegroups.com              fail pass       googlegroups.com              2
2025-11-14 14:32:00 Outlook.com                  74.125.224.63           fail pass       googlegroups.com              fail pass       googlegroups.com              1
2025-11-14 14:32:00 Outlook.com                  209.85.222.53           fail pass       ggithub.com                   fail pass       googlegroups.com              1
2025-11-14 14:32:00 Outlook.com                  209.85.128.192          fail pass       googlegroups.com              fail pass       googlegroups.com              2
2025-11-14 14:32:00 Outlook.com                  209.85.128.187          fail pass       googlegroups.com              fail pass       googlegroups.com              1
2025-11-14 14:32:00 testitst.com                 209.85.128.185          fail pass       googlegroups.com              fail pass       googlegroups.com              1
2025-11-14 14:32:00 instagram.com                209.85.128.184          fail pass       googlegroups.com              fail pass       googlegroups.com              1
2025-11-14 14:32:00 Outlook.com                  88.88.177.118           fail pass       gmgithub.com                  pass pass       blabla.com                    1
2025-11-14 14:32:00 Netze des Bundes             133.33.133.133          pass pass, pass mx.xxxxxx.com, xxxx.com       pass pass       blabla.com                    1
2025-11-14 14:32:00 statens-it.dk                0.44.123.123            pass pass       github.com                    pass pass       blabla.com                    1
2025-11-14 14:32:00 yahoo.com                    192.168.0.1             pass pass       github.com                    pass none       blabla.com                    1
